{"version":3,"sources":["assets\\Script\\panel\\Sign.js"],"names":["GameConfig","require","GameTools","GameUiTools","cc","Class","Component","properties","signbg","type","Sprite","displayName","choose","Node","signBtn","doubleSignBtn","onLoad","IS_GAME_SHARE","active","setPosition","hasCheckedToday","color","Color","removeComponent","Button","window","cp","SignDay","getItemByLocalStorage","day","hasChecked","i","setSpriteFrame","console","log","lastCheckInTimestamp","now","Date","todayBeginTimestamp","getFullYear","getMonth","getDate","getTime","close","playSimpleAudioEngine","node","destroy","disableBtn","doubleSign","coins","showDialog","sys","platform","WECHAT_GAME","BYTEDANCE_GAME","_createVedioAd","res","isEnded","raw","GameCoin","showToast","setItemByLocalStorage","GameMoney","sign"],"mappings":"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","sourceRoot":"/","sourcesContent":["var GameConfig = require(\"GameConfig\");\nvar GameTools = require(\"GameTools\");\nvar GameUiTools = require(\"GameUiTools\");\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        signbg:{\n            default:[],\n            type:cc.Sprite,\n            displayName:\"签到背景图片\"\n        },\n        choose:{\n            default:[],\n            type:cc.Node,\n            displayName:\"勾\"\n        },\n        signBtn:{\n            default:null,\n            type:cc.Node,\n            displayName:\"签到按钮\"\n        },\n        doubleSignBtn:{\n            default:null,\n            type:cc.Node,\n            displayName:\"双倍领取\"\n        }\n    },\n    onLoad() {\n        // GameTools.setItemByLocalStorage(\"checkInTimestamp\",0);\n        // GameTools.setItemByLocalStorage(\"checkInDays\",0);\n        if(!GameConfig.IS_GAME_SHARE){\n            this.doubleSignBtn.active = false;\n            this.signBtn.setPosition(0,-488);\n        }\n        if (this.hasCheckedToday()) {\n            // GameTools.showToast('已签到');\n            this.signBtn.color = new cc.Color(125, 125, 125);\n            this.signBtn.removeComponent(cc.Button);\n            this.doubleSignBtn.color = new cc.Color(125, 125, 125);\n            this.doubleSignBtn.removeComponent(cc.Button);\n        }\n\n        // this.isClick = false;\n        window.cp = this;\n        this.SignDay = GameTools.getItemByLocalStorage('checkInDays',0);\n        this.day = this.SignDay % 7;\n        let hasChecked = this.hasCheckedToday();\n        for(let i = 0;i<7;i++){\n            if(i<this.day || (this.day === 0 && hasChecked)){\n                this.choose[i].active = true;\n                GameUiTools.setSpriteFrame(\"sign/bb2\",this.signbg[i]);\n            }else if(i === this.day && hasChecked){\n                this.choose[i].active = false;\n                // this.takens[i].opacity = 0;\n            }else{\n                this.choose[i].active = false;\n                // this.takens[i].opacity = 0;\n            }\n        }\n    },\n    //判断今天是否签到\n    hasCheckedToday() {\n        console.log(\"判断今天是否签到\")\n        let lastCheckInTimestamp = GameTools.getItemByLocalStorage(\"checkInTimestamp\",0);\n        let now = new Date();\n        let todayBeginTimestamp = new Date(now.getFullYear(), now.getMonth(), now.getDate()).getTime();\n        return lastCheckInTimestamp >= todayBeginTimestamp;//真为已签到，假没签到\n    },\n\n    close: function () {\n        GameTools.playSimpleAudioEngine(3);\n        this.node.destroy();\n    },\n\n    disableBtn: function (day) {\n        // window.cp.takens[day].opacity = 255;\n        window.cp.choose[day].active = true;\n        GameUiTools.setSpriteFrame(\"sign/bb2\",window.cp.signbg[day]);\n        window.cp.doubleSignBtn.color = new cc.Color(125, 125, 125);\n        window.cp.doubleSignBtn.removeComponent(cc.Button);\n        window.cp.signBtn.color = new cc.Color(125, 125, 125);\n        window.cp.signBtn.removeComponent(cc.Button);\n    },\n    doubleSign: function () {\n        GameTools.playSimpleAudioEngine(3);\n        // this.isClick = true;\n        let coins = [4000, 200, 8000, 400, 16000, 800, 30000];\n        if (this.hasCheckedToday()) {\n            console.log(\"已经签到\")\n            GameTools.showDialog('已经签到');\n            return;\n        }\n        if(cc.sys.platform === cc.sys.WECHAT_GAME){\n            // wx.aldSendEvent('看视频双倍签到',{'key' : 'value'});\n        }else if(cc.sys.platform === cc.sys.BYTEDANCE_GAME){\n\n        }\n        GameTools._createVedioAd(function (res) {\n            if (res.isEnded || res.raw) {\n                if(window.cp.day % 2 != 0){\n                    GameConfig.GameCoin += coins[window.cp.day];\n                    GameTools.showToast(\"获得元宝+\" + coins[window.cp.day]);\n                    GameTools.setItemByLocalStorage(\"GameCoin\",GameConfig.GameCoin);\n                }else{\n                    GameConfig.GameMoney += coins[window.cp.day];\n                    GameTools.showToast(\"获得铜钱+\" + coins[window.cp.day]);\n                    GameTools.setItemByLocalStorage(\"GameMoney\",GameConfig.GameMoney);\n                }\n\n                window.cp.disableBtn(window.cp.day);//按钮的判断\n                GameTools.setItemByLocalStorage(\"checkInDays\",window.cp.SignDay+1);\n                GameTools.setItemByLocalStorage(\"checkInTimestamp\",Date.now());\n            }\n        });\n\n    },\n\n    sign: function () {\n        GameTools.playSimpleAudioEngine(3);\n        let coins = [2000, 100, 4000, 200, 8000, 400, 15000];\n\n        if (this.hasCheckedToday()) {\n            console.log(\"已经签到\")\n            GameTools.showDialog('已经签到');\n            return;\n        }\n        if(this.day % 2 != 0){\n            GameConfig.GameCoin += coins[this.day];\n            GameTools.showToast(\"获得元宝+\" + coins[this.day]);\n            GameTools.setItemByLocalStorage(\"GameCoin\",GameConfig.GameCoin);\n        }else{\n            GameConfig.GameMoney += coins[this.day];\n            GameTools.showToast(\"获得铜钱+\" + coins[this.day]);\n            GameTools.setItemByLocalStorage(\"GameMoney\",GameConfig.GameMoney);\n        }\n\n        window.cp.disableBtn(this.day);//按钮的判断\n        GameTools.setItemByLocalStorage(\"checkInDays\",this.SignDay+1);\n        GameTools.setItemByLocalStorage(\"checkInTimestamp\",Date.now());\n        // GameData.setSignDay(GameData.getSignDay()+1);\n        // GameData.setCheckInTimestamp(Date.now());\n    },\n});\n"]}